<section id="before-after-product" class="before-after-product-section" style="position: relative; max-width: 1400px; margin: 0 auto; padding: 50px 0;">
  <div class="before-after-wrapper" style="display: flex; position: relative; overflow: hidden;">

    <!-- BEFORE IMAGE GRID -->
    <div class="before-content" style="flex: 1; position: relative; width: 50%; transition: width 0.3s ease;">
      <span style="
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0,0,0,0.6);
        color: #fff;
        padding: 5px 10px;
        font-weight: bold;
        border-radius: 4px;
        z-index: 5;
      ">Before</span>

      <!-- Main Before Image -->
      <img 
        src="{{ section.settings.before_main_image | img_url: '2048x2048' }}" 
        alt="Before" 
        width="1024" 
        height="1024"
        style="width: 100%; display: block;"
      >

      <!-- Sub Images -->
      <div class="before-sub-images" style="display: flex; margin-top: 10px; gap: 10px;">
        {% for block in section.blocks %}
          {% if block.type == 'before_sub_image' %}
            <img 
              src="{{ block.settings.image | img_url: '600x600' }}" 
              alt="Before Sub" 
              width="300" 
              height="300"
              style="width: 50%; display: block;"
            >
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <!-- AFTER PRODUCT CARD -->
    <div class="after-content" style="flex: 1; background: #fff; padding: 20px; position: relative; width: 50%; transition: width 0.3s ease; overflow: hidden;">
      <span style="
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0,0,0,0.6);
        color: #fff;
        padding: 5px 10px;
        font-weight: bold;
        border-radius: 4px;
        z-index: 5;
      ">After</span>

      <div class="after-inner" style="padding-left: 20px;">
        <h2>{{ section.settings.product_title }}</h2>
        <p>{{ section.settings.product_description }}</p>
        <button style="padding: 10px 20px; margin-bottom: 10px; background: black; color: white; border: none; cursor: pointer;">Add to Cart</button>
        <button style="padding: 10px 20px; background: black; color: white; border: none; cursor: pointer;">Buy it Now</button>

        <ul style="margin-top: 20px;">
          {% for block in section.blocks %}
            {% if block.type == 'product_feature' %}
              <li>âœ” {{ block.settings.feature_text }}</li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>
    </div>

    <!-- SLIDER HANDLE -->
    <div class="before-after-handle" style="
      position: absolute;
      top: 0;
      left: 50%;
      width: 4px;
      height: 100%;
      background: #000;
      cursor: ew-resize;
      z-index: 10;
      transition: left 0.3s ease;
    "></div>

  </div>

  <!-- Include JS with defer -->
  <script src="{{ 'before-after-product.js' | asset_url }}" defer></script>
</section>

{% schema %}
{
  "name": "Before & After Product",
  "blocks": [
    {
      "type": "before_sub_image",
      "name": "Before Sub Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Sub Image"
        }
      ]
    },
    {
      "type": "product_feature",
      "name": "Product Feature",
      "settings": [
        {
          "type": "text",
          "id": "feature_text",
          "label": "Feature Text"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "image_picker",
      "id": "before_main_image",
      "label": "Before Main Image"
    },
    {
      "type": "text",
      "id": "product_title",
      "label": "Product Title",
      "default": "EchoHEARS"
    },
    {
      "type": "textarea",
      "id": "product_description",
      "label": "Product Description",
      "default": "Protect your hearing without muting the music..."
    }
  ],
  "presets": [
    {
      "name": "Before & After Product",
      "category": "Custom"
    }
  ]
}
{% endschema %}
